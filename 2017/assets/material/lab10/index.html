<!DOCTYPE html><html>

<head>
<meta charset="utf-8">
<title>README</title>
<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>
</head>
<body>
<p><img src="cs171-logo.png" width="200"></p>

<p>&nbsp;</p>

<h1 id="toc_0">Lab 10</h1>

<h3 id="toc_1">Learning Objectives</h3>

<ul>
<li>Know how to create custom visualizations with D3

<ul>
<li>Set up a completely new project without templates</li>
<li>Consolidate the official documentation and external materials</li>
<li>Apply the learned web development skills and your deep understanding of D3 to realize your own ideas and to implement unique visualizations (apart from bar and area charts)</li>
</ul></li>
</ul>

<h3 id="toc_2">Prerequisites</h3>

<ul>
<li>You have read the section <strong>Creating a Unique Visualization</strong> of the article <em>Custom Visualizations with D3.js</em>: <a href="http://jsdatav.is/chap07.html#creating-a-unique-visualization">http://jsdatav.is/chap07.html#creating-a-unique-visualization</a></li>
<li>You have successfully filled in the pre-quiz for the 10th lab.</li>
</ul>

<h2 id="toc_3">Padgett&#39;s Florentines Families</h2>

<p>In this problem set you will work primarily with network data. The data sources about marriage and business ties among Renaissance Florentine families were originally collected by Padgett [1] and then made available to the public. The dataset includes important families that were involved in a struggle for political control in Florence around 1430. With the collected data researchers can analyze the influence of individual families and, in addition, it allows them to get a better understanding of the impact of building various kinds of relationships.</p>

<p>Each network consists of 16 families of the citiy of Florence in the early 15th century. In the graph, a family is represented as a node and marriages or business ties are the relations between these nodes. All the relations we consider are nondirectional (symmetrical).</p>

<p>[1] Padgett, J.F. (1994): Marriage and Elite Structure in Renaissance Florence, 1282-1500. (<a href="http://home.uchicago.edu/%7Ejpadgett/papers/unpublished/maelite.pdf">http://home.uchicago.edu/~jpadgett/papers/unpublished/maelite.pdf</a>)</p>

<h3 id="toc_4">Data</h3>

<p>When we work with network data we usually distinguish between the matrix and the edgelist-format.</p>

<ul>
<li><p>Edgelist: It is a simple way to represent a network as a basic list (e.g. csv file). Each row contains two IDs (vertex numbers) and defines one edge. If edges have weights, you can add a third column with the individual values. The advantage of using this format is that you can store additional edge information by appending more columns.</p></li>
<li><p>Adjaceny matrix: If a graph has <em>n</em> vertices we can store the data in an n × n matrix. Data stored in this format is in many cases very convenient for the further processing in JS and D3. For example, we can query it easily with <code>graph[i][j]</code>. The disadvantage of matrices is that they use a lot of space to represent only a few edges.</p></li>
</ul>

<p>The data for this lab is stored in two adjacency matrices and a csv file which provides meta information:</p>

<ol>
<li><p>Dataset: <strong><a href="http://www.cs171.org/2016/assets/scripts/lab10/florentine-familiy-attributes.csv"><code>florentine-family-attributes.csv</code></a></strong></p>

<ul>
<li>Family</li>
<li>Wealth (each family&#39;s net wealth in thousands of lira; in 1427)</li>
<li>Priorates (seats on the civic council)</li>
</ul>

<pre><code class="language-csv">&quot;Family&quot;,&quot;Wealth&quot;,&quot;NumberPriorates&quot;
&quot;Acciaiuoli&quot;,10,53
&quot;Albizzi&quot;,36,65
&quot;Barbadori&quot;,55,NA
&quot;Bischeri&quot;,44,12
...</code></pre>

<p><em>You will use the above dataset as a meta information for the networks. The family in the first row in the above dataset corresponds to the family in the first row and column of the adjacency matrices. The family in second row corresponds to the second row/column of the adjacency matrix, etc.</em></p></li>
<li><p>Adjacency matrix: <strong>Marriages</strong></p>

<p>0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0<br/>
0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0<br/>
0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0<br/>
0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0<br/>
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br/>
0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1<br/>
0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0<br/>
1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1<br/>
0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0<br/>
0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0<br/>
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1<br/>
0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0<br/>
0,0,0,1,1,0,0,0,0,0,1,0,1,0,0,0<br/>
0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0<br/></p></li>
<li><p>Adjacency matrix: <strong>Business Ties</strong></p>

<p>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br/>
0,0,0,0,1,1,0,0,1,0,1,0,0,0,0,0<br/>
0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0<br/>
0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0<br/>
0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0<br/>
0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0<br/>
0,0,0,1,1,0,1,0,0,0,1,0,0,0,0,0<br/>
0,0,1,0,0,1,0,0,0,1,0,0,0,1,0,1<br/>
0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0<br/>
0,0,1,1,1,0,0,1,0,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br/>
0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0<br/></p></li>
</ol>

<p><em>Source: <a href="http://svitsrv25.epfl.ch/R-doc/library/ergm/html/flomarriage.html">http://svitsrv25.epfl.ch/R-doc/library/ergm/html/flomarriage.html</a></em></p>

<h2 id="toc_5">Implementation</h2>

<p>In contrast to all our previous labs we won&#39;t give you a step-by-step instruction or template today. By working through the different examples of all previous labs and homeworks, you have constantly developed and improved your JS &amp; D3 skillset. You now have all the knowledge and experience that is needed to solve this task independently. Therefore, we will just give you a description what we expect as a result. A few additional hints should help you to overcome certain hurdles.</p>

<h4 id="toc_6">Preview &amp; Problem Description</h4>

<p>In this lab you will build a custom visualization with D3 that will look like this one:</p>

<p><img src="cs171-lab10-preview.gif?raw=true" alt="Lab 10 - Preview" title="Lab 10 - Preview"></p>

<p>This sortable matrix visualization can encode two types of relationships simultaneously. Especially when we want to display a network with many edges it is definetly worth to consider a matrix representation instead of a network graph.</p>

<p><em>Implementation checklist:</em></p>

<ul>
<li>Create a matrix visualization that visualizes the relations between these 16 families</li>
<li>Merge the datasets and label the rows and columns with the corresponding family names</li>
<li>Draw two triangles in each cell to encode both relationships (marriages and business ties)</li>
<li>Make the matrix sortable (at least the rows but optionally also the columns)</li>
<li>Include animated transitions to make it easier to follow changes</li>
<li>Add a legend to explain the types of relationships</li>
</ul>

<p><em>We suggest that you go through the following four iterations:</em></p>

<p><img src="cs171-lab10-iterations.png?raw=true" alt="Lab 10 - Iterations" title="Lab 10 - Iterations"></p>

<hr>

<h4 id="toc_7">Get started</h4>

<p>Set up a new D3 project (HTML, CSS, JS files). You can download D3 version 3 here: <a href="http://d3js.org/d3.v3.min.js">http://d3js.org/d3.v3.min.js</a></p>

<p>Please download the CSV file: <a href="http://www.cs171.org/2016/assets/scripts/lab10/florentine-familiy-attributes.csv">http://www.cs171.org/2016/assets/scripts/lab10/florentine-familiy-attributes.csv</a></p>

<p>Copy the adjacency matrices from above and integrate them in your code. They are only available in this raw text format.</p>

<hr>

<h4 id="toc_8">Create a matrix visualization with D3</h4>

<p>D3 is an extremely flexible library, thus, there are multiple ways to draw matrix visualizations / heatmaps. One option is to store the data in a two-dimensional array. In the first step you can iterate through the first dimension (rows) and append for each array a new SVG group-element. Group-elements have no direct visual appearence but you can use, for example, the <code>transform</code> attribute to shift all the elements within the group along the y-axis.</p>

<p>In the second step you can iterate through the second dimension (columns). Each row contains an array with a sequence of 0 or 1. Depending on the value you can draw a grey or colored rectangle. Of course, you can also skip this intermediate step and instead directly draw two triangles for each matrix element.</p>

<hr>

<h4 id="toc_9">Data wrangling</h4>

<p>A good approach would be to preprocess the data first and to merge all three datasets (<code>wrangleData()</code>). You can create a new JS object for each family with the surname and sub-arrays for marriages and business ties. This structure would also help you later to efficiently sort the dataset, because you can add additional attributes, such as the number of business ties for each family.</p>

<p><em>Example structure:</em></p>

<pre><code class="language-javascript">var data = [
    {
        ...
    },
    {
        &quot;index&quot;: 8,
        &quot;name&quot;: &quot;Medici&quot;,
        &quot;allRelations&quot;: 11,
        &quot;businessTies&quot;: 5,
        &quot;businessValues&quot;: [0,0,1,0,0,1,0,0,0,1,0,0,0,1,0,1],
        &quot;marriages&quot;: 6,
        &quot;marriageValues&quot;: [1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1],
        &quot;numberPriorates&quot;: 53,
        wealth: 103
    },
    {
        &quot;index&quot;: 9,
        &quot;name&quot;: &quot;Pazzi&quot;,
        ...
    }
];</code></pre>

<hr>

<h4 id="toc_10">Draw triangles in D3</h4>

<p>In the preview and the problem description we have introduced the idea of encoding two relations in one single cell. Instead of drawing one rectangle we can stack two triangles on top of each other. As a result users can see at first glance which families have multiple relationships and other further details.</p>

<p><img src="cs171-lab10-triangles.png" width="300"></p>

<p>In SVG you can create lines, circles, rectangles etc but not directly triangles. Therefore, you have to use the <em>path</em> element. You have used SVG&#39;s path already, but most likely always in combination with the D3 path generator. Now you have to specify the path manually.</p>

<p>The path information is specified within the <code>d</code> attribute:</p>

<pre><code class="language-javascript">&lt;svg height=&quot;250&quot; width=&quot;300&quot;&gt;
  &lt;path d=&quot;M150 5 L75 200 L225 200 Z&quot;  fill=&quot;blue&quot; /&gt;
&lt;/svg&gt;</code></pre>

<ul>
<li><code>M</code>: translates to &quot;move to&quot; and specifies the starting point (x/y coordinate)</li>
<li><code>L</code>: translates to &quot;line to&quot; and draws a line from the current point to the following coordinates</li>
<li><code>Z</code>: translates to &quot;close path&quot;. It closes the triangle path by connecting the last point with our initial point.</li>
</ul>

<p>There are more commands but for our use case the above mentioned options are sufficient. <em>Important: uppercase commands indicate absolute coordinates and their lowercase counterparts indicate a coordinate relative to the previous coordinate.</em></p>

<p><img src="cs171-lab10-triangle-path.png" width="240"></p>

<p><em>Example code snippet for the upper triangle (#1):</em></p>

<pre><code class="language-javascript">var cellHeight = 20, cellWidth = 20, cellPadding = 10;

// D3&#39;s enter, update, exit pattern
var trianglePath = row.selectAll(&quot;.triangle-path&quot;)
    .data(data);

trianglePath.enter().append(&quot;path&quot;)
    .attr(&quot;class&quot;, &quot;triangle-path&quot;);

trianglePath.attr(&quot;d&quot;, function(d, index) {
    // Shift the triangles on the x-axis (columns)
    var x = (cellWidth + cellPadding) * index;
    
    // All triangles of the same row have the same y-coordinates
    // Vertical shifting is already done by transforming the group elements
    var y = 0;
    
    return &#39;M &#39; + x +&#39; &#39;+ y + &#39; l &#39; + cellWidth + &#39; 0 l 0 &#39; + cellHeight + &#39; z&#39;;
});</code></pre>

<hr>

<h4 id="toc_11">Sortable matrix</h4>

<p>After you have implemented your custom matrix visualization, including triangles, you should improve it with a basic sorting function.</p>

<p>The user should be able to sort the rows by</p>

<ul>
<li>Number of business ties</li>
<li>Number of marriages</li>
<li>Number of all relationships</li>
<li>Wealth</li>
<li>Number of seats hold in the civic council (priorates)</li>
</ul>

<p>By default the families should be ordered by their surname.</p>

<p>As already mentioned above, it is very helpful if you merge the datasets and create a JS object for each family. That gives you the possibility to calculate the statistics (e.g. count all business ties for each family) in advance.</p>

<p>Integrate a select-box with the sorting options and react t change events. If you have implemented D3&#39;s <em>enter, update, exit pattern</em> you can call the <code>updateVis()</code> function, sort the families and update the visual elements.</p>

<p>Include animated transitions that make it easier to follow when the sorting of the data is being updated. When the user sorts the data, a particular data point (family in our case) can be tracked visually through the transition. This concept is called <em>object constancy</em> and you can adopt it by specifying a <strong>key function</strong>. You have already learned how to implement it:</p>

<pre><code class="language-javascript">var row = svg.selectAll(&quot;.row&quot;)
    .data(data, function(d){ return d.name; });</code></pre>

<p><img src="cs171-lab10-transition.gif" width="400"></p>

<p><em>(Notice: we made the transition particulary slow for demonstration purposes)</em></p>

<p>You can also change the <code>fill-opacity</code> during the transition for a cleaner animation.</p>

<hr>

<h4 id="toc_12">Bonus Activity 1 - Flexible layout</h4>

<p>You have probably used hard-coded values for all size specifications in your view. Adapt your matrix implementation so that it is possible to define an SVG area (width and height) and the sizes of all other elements and the spacing between them will be calculated automatically.</p>

<hr>

<h4 id="toc_13">Bonus Activity 2 - Highlight cells on <em>mouseover</em></h4>

<p>Listen to mouse events: If the user hovers over a cell highlight all elements that are in the same row or in the same column of the matrix. </p>

<p><em>Preview:</em></p>

<p><img src="cs171-lab10-mouseover.gif" width="400"></p>

<hr>

<h4 id="toc_14">Submission of 1-minute paper</h4>

<p>Congratulations, you have now completed Lab 10! Please submit your 1-minute paper now!</p>

<hr>

<h4 id="toc_15">Submission of lab</h4>

<p>Please upload the code of your completed lab (the sortable matrix visualization and optionally the bonus activities) on Vocareum! </p>

<hr>

<p><strong>Resources</strong></p>

<ul>
<li>Custom visualizations with D3: <a href="http://jsdatav.is/chap07.html#creating-a-unique-visualization">http://jsdatav.is/chap07.html#creating-a-unique-visualization</a></li>
<li>SVG for beginners: <a href="http://unicorn-ui.com/blog/svg-for-beginners.html">http://unicorn-ui.com/blog/svg-for-beginners.html</a></li>
<li>D3 object constancy: <a href="https://bost.ocks.org/mike/constancy/">https://bost.ocks.org/mike/constancy/</a></li>
<li>Padgett Florentines Families: <a href="http://home.uchicago.edu/%7Ejpadgett/papers/unpublished/maelite.pdf">http://home.uchicago.edu/~jpadgett/papers/unpublished/maelite.pdf</a></li>
</ul>


</body>

</html>
